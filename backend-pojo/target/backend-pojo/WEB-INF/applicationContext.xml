<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

    <context:annotation-config/>
    <context:component-scan base-package="com.oxiane.caveavin"/>

    <bean scope="singleton" class="com.oxiane.caveavin.provider.ObjectMapperContextResolver"/>

    <bean id="hosts" class="java.util.ArrayList">
        <constructor-arg>
            <list>
                <bean class="java.net.URI">
                    <constructor-arg value="http://127.0.0.1:8091/pools"/>
                </bean>
            </list>
        </constructor-arg>
    </bean>

    <bean id="couchbaseClient" class="com.couchbase.client.CouchbaseClient">
        <constructor-arg index="0" ref="hosts"/>
        <constructor-arg index="1" value="oxiane"/>
        <constructor-arg index="2" value=""/>
    </bean>

    <bean id="bouteilleDao" class="com.oxiane.caveavin.dao.impl.CouchDao">
        <constructor-arg index="0" ref="couchbaseClient"/>
        <constructor-arg index="1">
            <bean class="com.oxiane.caveavin.mapper.impl.DocMapper">
                <constructor-arg type="java.lang.Class" value="com.oxiane.caveavin.bean.Vin"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="2" value="caveavin"/>
        <constructor-arg index="3" value="vin_exerpt"/>
    </bean>

    <bean id="contactDao" class="com.oxiane.caveavin.dao.impl.CouchDao">
        <constructor-arg index="0" ref="couchbaseClient"/>
        <constructor-arg index="1">
            <bean class="com.oxiane.caveavin.mapper.impl.DocMapper">
                <constructor-arg type="java.lang.Class" value="com.oxiane.caveavin.bean.Message"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="2" value="caveavin"/>
        <constructor-arg index="3" value="message_exerpt"/>
    </bean>

    <bean id="domaineDao" class="com.oxiane.caveavin.dao.impl.CouchDao">
        <constructor-arg index="0" ref="couchbaseClient"/>
        <constructor-arg index="1">
            <bean class="com.oxiane.caveavin.mapper.impl.DocMapper">
                <constructor-arg type="java.lang.Class" value="com.oxiane.caveavin.bean.Domaine"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="2" value="caveavin"/>
        <constructor-arg index="3" value="domaine_exerpt"/>
    </bean>

    <bean id="domaineResource" class="com.oxiane.caveavin.rest.DomaineResource">
        <property name="dao" ref="domaineDao"/>
    </bean>

    <bean id="vinResource" class="com.oxiane.caveavin.rest.VinResource">
    <property name="dao" ref="bouteilleDao"/>
    </bean>

    <bean id="contactResource" class="com.oxiane.caveavin.rest.ContactResource">
        <property name="dao" ref="contactDao"/>
    </bean>


</beans>